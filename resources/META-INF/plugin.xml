<idea-plugin>
  <id>com.badahori.creatures.plugins.intellij.agenteering</id>
  <name>Creatures CAOS and Agenteering</name>
  <version>0.01.6</version>
  <vendor>Bedalton</vendor>

  <description><![CDATA[
    This plugin aims to provide simple CAOS and agent editing for a variety of Creatures variants<br/>
    <b>Supports:</b><br/>
    <ul>
      <li>Creatures 1</li>
      <li>Creatures 2</li>
      <li>Creatures Village (Mostly)</li>
      <li>Creatures 3</li>
      <li>Docking Station</li>
    </ul>
    <b>Implemented</b>
    <ul>
      <li>Syntax Highlighting</li>
      <li>Basic completion</li>
      <li>Definition reference</li>
      <li>Parameter hints</li>
      <li>Known value completion from list. (ie. Drives or Chemicals by name)</li>
      <li>Sprite viewers</li>
    </ul>
    <b>Todo:</b>
    <ul>
      <li>COB compiler/decompiler</li>
      <li>Pray File editing</li>
      <li>Sprite compilers</li>
    </ul>
    ]]></description>

  <change-notes><![CDATA[
    <ul>
      <li>
        <b>Version: 0.01.6</b><br/>
        <b>#Fixes</b>
        <ul>
          <li>Removed request for script literal string on COS file creation</li>
          <li>Errors in file creation</li>
          <li>Fix C3/DS Raw CAOS injection</li>
          <li>Bad parsing on SCRP element following macro</li>
          <li>'event' type hint prefix not showing on event numbers without named event</li>
        </ul>
        <b>#Improvements</b>
        <ul>
          <li>Added action to swap inverted min/max values in C1</li>
        </ul>
        <b>#New Inspections</b>>
        <ul>
          <li>Interleaving body scripts in C3/DS</li>
          <li>Multiple removal scripts in C3/DS</li>
          <li>Ignored code after removal script inspection in C3/DS</li>
          <li>Duplicate event script numbers</li>
        </ul>
      </li>
      </li>
      <li>
        <b>Version: 0.01.5</b><br/>
        <b>#Fixes</b>
        <ul>
          <li>Parser error on space only value in C1 style strings</li>
          <li>C3 injector reporting success on invalid output</li>
        </ul>
        <b>#Improvements</b>
        <ul>
          <li>Add inspection for more than one event script in C1/C2 files</li>
          <li>Remove CV+ injector dependents on .NET 4.5</li>
        </ul>
      </li>
      <li>
        <b>Version: 0.01.4</b><br/>
        <b>#Fixes</b>
        <ul>
          <li>Missing errors on unterminated control statements (ie. missing ENDI)
          <li>BASE command not registering due to bad doc comment</li>
          <li>Erroneous error on char '\\'</li>
          <li>Extra spaces not being marked as errors</li>
        </ul>
        <b>#Improvements</b>
        <ul>
          <li>Fold commands to single line</li>
          <li>Allow separate colorization of VAxx,OVx and MVxx variables</li>
        </ul>
      </li>
      <li>
        <b>Version: 0.01.3</b><br/>
        <b>#Fixes</b>
        <ul>
          <li>Exception on concurrent access to AST expectsArray</li>
          <li>Collapse to single line action not collapsing multiple new lines or comments</li>
        </ul>
        <b>#Improvements</b>
        <ul>
          <li>Fold CV+ Chemicals, Drives and Stimulus, and CA's</li>
          <li>Color scheme editor for CAOS definition files</li>
          <li>Add clickable regions to CAOS definition file doc comment code blocks</li>
          <li>Add highlighting for same variable usage</li>
        </ul>
    </ul>
    </li>
    <li>
      <b>Version: 0.01.2</b>
      <ul>
        <li>fix autocomplete changing numbers to variables</li>
      </ul>
    </li>
    <li>
      <b>Version: 0.01.00</b>
      <ul>
        <li>initial implementation</li>
        <li>Syntax Highlighting</li>
        <li>Basic completion</li>
        <li>Definition reference</li>
        <li>Parameter hints</li>
      </ul>
    </li>
    </ul>
    ]]>
  </change-notes>

  <!-- please see http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/build_number_ranges.html for description -->
  <idea-version since-build="191.5600" />

  <!-- please see http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html
       on how to target different products -->
  <depends>com.intellij.modules.platform</depends>
  <depends>com.intellij.modules.lang</depends>
  <depends>com.intellij.modules.java</depends>

  <extensions defaultExtensionNs="com.intellij">


    <!-- ======================== -->
    <!-- ===== CAOS Script ====== -->
    <!-- ======================== -->
    <!-- LANG -->
    <fileTypeFactory
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.lang.CaosScriptFileTypeFactory" />
    <lang.parserDefinition
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.parser.CaosScriptParserDefinition"
        language="CaosScript" />
    <editorNotificationProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.project.editor.CaosScriptEditorToolbar" />
    <lang.findUsagesProvider language="CaosScript"
                             implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.references.CaosScriptUsagesProvider" />
    <moduleType id="CAOS_MODULE"
                implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.project.module.CaosScriptModuleType"
                classpathProvider="true" />

    <!-- Completion -->
    <completion.contributor language="CaosScript"
                            implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.completion.CaosScriptCompletionContributor" />
    <editorTypedHandler
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.completion.CaosScriptTypedHandler"
    />

    <!-- Project -->
    <iconProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.project.module.CaosModuleIconProvider"
    />
    <projectTemplatesFactory
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.project.template.CaosScriptTemplateFactory" />
    <moduleConfigurationEditorProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.project.module.CaosModuleConfigurationEditorProvider" />
    <!-- Formatting -->
    <lang.formatter language="CaosScript"
                    implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptFormattingModelBuilder" />

    <!-- Code Style Settings -->
    <codeStyleSettingsProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptCodeStyleSettingsProvider" />
    <langCodeStyleSettingsProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptLanguageCodeStyleSettingsProvider" />

    <!-- Highlighting -->
    <lang.syntaxHighlighterFactory
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.highlighting.CaosScriptSyntaxHighlighterFactory"
        language="CaosScript"
        key="CaosScript"
    />
    <colorSettingsPage
        language="CaosScript"
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.highlighting.CaosScriptColorSettingsPage" />
    <annotator language="CaosScript"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.highlighting.CaosScriptHighlighterAnnotator" />
    <additionalTextAttributes scheme="Default" file="colorSchemes/CaosScriptColorSchemeDefault.xml" />
    <additionalTextAttributes scheme="Darcula" dark="true" file="colorSchemes/CaosScriptColorSchemeDarcula.xml" />

    <!-- Annotators -->
    <annotator language="CaosScript"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.annotators.CaosScriptSyntaxErrorAnnotator" />
    <annotator language="CaosScript"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.annotators.CaosScriptEnumAnnotator"
               order="first"
    />
    <annotator language="CaosScript"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.annotators.CaosScriptCommandCaseAnnotator" />
    <annotator language="CaosScript"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.annotators.CaosScriptGhostElementAnnotator" />

    <!-- Inspections -->
    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptTypesInspection"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Expected parameter type"
                     shortName="ExpectedParameterType"
                     order="last"
    />
    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptCAssignmentInspection"
                     level="ERROR"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Assigned value is of expected type"
                     shortName="ExpectedAssigmentType"
    />

    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptSubroutineInspection"
                     level="ERROR"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Subroutine Is Defined Check"
                     shortName="SubroutineIsDefined"
    />
    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptRandomVarOutOfOrderInspection"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="RNDV values out of order"
                     shortName="RNDVOutOfOrder"
    />

    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptInterleavingBodyStatements"
                     level="WEAK WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Interleaving body script elements"
                     shortName="InterleavingBodyScripts"
    />

    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptIgnoredScriptsAfterRemovalScriptInspection"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Scripts after removal scripts are ignored"
                     shortName="ScriptsAfterRemovalScripts"
                     />

    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptMultipleRemovalScriptInspection"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Multiple removal scripts"
                     shortName="MultipleRemovalScripts"
    />
    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptRandomValueIsTheSameInspection"
                     level="WEAK WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Rndv value is always the same"
                     shortName="RndvIsTheSame"
    />

    <localInspection language="CaosScript"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosCommandUndocumentedCommandUsage"
                     level="WEAK WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Undocumented command usage"
                     shortName="UndocumentedCommandUsage"
    />

    <localInspection language="CaosScript"
                     level="INFORMATION"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Collapse Expand Lines"
                     shortName="CollapseExpandLines"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.annotators.CaosScriptHelperActionAnnotator" />

    <localInspection language="CaosScript"
                     level="ERROR"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Scripts defined after event script in C1/C2"
                     shortName="ScriptAfterEventScriptC1"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptMultipleScriptsInC1File"
                      />

    <localInspection language="CaosScript"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Invalid script header value"
                     shortName="InvalidScriptHeaderValue"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptInvalidScriptHeaderValueInspection"
    />

    <localInspection language="CaosScript"
                     level="WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Duplicate event script in file"
                     shortName="DuplicateEventScriptInFile"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptDuplicateEventScriptInFileInspection"
    />

    <localInspection language="CaosScript"
                     level="WEAK WARNING"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="Duplicate event script in module"
                     shortName="DuplicateEventScriptInModule"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptDuplicateEventScriptInModuleInspection"
    />


    <localInspection language="CaosScript"
                     level="ERROR"
                     groupName="Caos Script"
                     enabledByDefault="true"
                     displayName="OBJP used without OWNR scope"
                     shortName="OBJPNoOwnrScope"
                     implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.inspections.CaosScriptObjpUsedOutsideOwnerScopeInspection"
    />

    <!-- Documentation & Hints -->
    <codeInsight.parameterNameHints language="CaosScript"
                                    implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.hints.CaosScriptInlayHintsProvider" />
    <documentationProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.documentation.CaosScriptDocumentationProvider" />

    <lang.foldingBuilder language="CaosScript"
                         implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.hints.CaosScriptStimFoldingBuilder" />
    <lang.foldingBuilder language="CaosScript"
                         implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptBlockFoldingBuilder" />
    <lang.braceMatcher language="CaosScript"
                       implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptBraceMatcher" />
    <lang.quoteHandler
        language="CaosScript"
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptQuoteHandler" />

    <!-- Indices -->
    <applicationService
        serviceInterface="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptIndexService"
        serviceImplementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptIndexServiceImpl" />
    <stubElementTypeHolder
        class="com.badahori.creatures.plugins.intellij.agenteering.caos.stubs.types.CaosScriptStubTypes" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptConstAssignmentIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptNamedVarAssignmentIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptNamedVarUseIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptSubroutineIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptVarAssignmentIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.indices.CaosScriptEventScriptIndex" />

    <!-- Actions -->
    <!--enterHandlerDelegate
        id="CaosScriptEnterDelegate"
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.formatting.CaosScriptEnterDelegate" / -->

    <!-- ======================== -->
    <!-- ======= CAOS DEF ======= -->
    <!-- ======================== -->
    <!-- LANG -->
    <lang.parserDefinition
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.parser.CaosDefParserDefinition"
        language="CaosDef" />
    <completion.contributor language="CaosDef"
                            implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.contributor.CaosDefCompletionContributor" />
    <lang.findUsagesProvider
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.references.CaosDefUsagesProvider"
        language="CaosDef" />

    <!-- Bundled Definitions -->
    <library.type
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.project.library.CaosLibraryType"
        id="CaosLibrary" />

    <!-- Highlighting -->
    <syntaxHighlighter
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefSyntaxHighlighter"
        key="CaosDef" />
    <lang.syntaxHighlighterFactory
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefSyntaxHighlighterFactory"
        language="CaosDef" />
    <annotator language="CaosDef"
               implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefHighlighterAnnotator" />
    <additionalTextAttributes scheme="Default" file="colorSchemes/CaosDefColorSchemeDefault.xml" />
    <additionalTextAttributes scheme="Darcula" file="colorSchemes/CaosDefColorSchemeDarcula.xml" />

    <lang.elementManipulator
        forClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.psi.impl.CaosDefCodeBlockImpl"
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefCodeBlockManipulator" />
    <languageInjector
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefCodeBlockInjector"
    />
    <!-- Indices -->
    <stubElementTypeHolder
        class="com.badahori.creatures.plugins.intellij.agenteering.caos.stubs.types.CaosScriptStubTypes" />
    <applicationService
        serviceInterface="com.badahori.creatures.plugins.intellij.agenteering.caos.def.indices.CaosDefStubIndexService"
        serviceImplementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.indices.CaosDefStubIndexServiceImpl" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.indices.CaosDefCommandElementsByNameIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.indices.CaosDefHashTagsIndex" />
    <stubIndex
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.indices.CaosDefValuesListElementsByNameIndex" />

    <!-- Formatting -->
    <lang.braceMatcher language="CaosDef"
                       implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.format.CaosDefBraceMatcher" />
    <enterBetweenBracesDelegate language="CaosDef"
                                implementationClass="com.badahori.creatures.plugins.intellij.agenteering.caos.def.format.CaosDefEnterBetweenBracesDelegate" />

    <colorSettingsPage
        language="CaosDef"
        implementation="com.badahori.creatures.plugins.intellij.agenteering.caos.def.highlighting.CaosDefColorSettingsPage" />

    <!-- =========================== -->
    <!-- ====== Sprite Files ======= -->
    <!-- =========================== -->
    <fileEditorProvider
        implementation="com.badahori.creatures.plugins.intellij.agenteering.sprites.editor.SpriteFileEditorProvider" />

    <fileType name="SPR file"
              implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sprites.spr.SprFileType"
              fieldName="INSTANCE"
              language="CreaturesSPR" extensions="spr" />

    <fileType name="S16 Sprite File"
              implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sprites.s16.S16FileType"
              fieldName="INSTANCE"
              language="CreaturesS16" extensions="s16" />

    <fileType name="C16 Sprite File"
              implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sprites.c16.C16FileType"
              fieldName="INSTANCE"
              language="CreaturesC16" extensions="c16" />



    <!-- SFC File Handling -->

    <!--filetype.decompiler filetype="SFCFile" implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sfc.SfcBinaryDecompiler" /-->

    <fileType name="SFCFile"
              implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sfc.lang.SfcFileType"
              fieldName="INSTANCE"
              language="PlainText"
              extensions="sfc"
    />

    <!--fileType.fileViewProviderFactory
        filetype="SfcFile"
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.sfc.lang.SfcEditorProviderFactory"
    /-->

    <treeStructureProvider implementation="com.badahori.creatures.plugins.intellij.agenteering.sfc.tree.SfcTreeStructureProvider" />


    <!-- Virtual File System -->
    <virtualFileSystem
        implementationClass="com.badahori.creatures.plugins.intellij.agenteering.vfs.CaosVirtualFileSystem"
        key="caosvfs"
    />
  </extensions>

  <actions>
    <!-- Add your actions here -->
    <action
        id="CaosScript.NewFile"
        icon="CaosScriptIcons.CAOS_FILE_ICON"
        class="com.badahori.creatures.plugins.intellij.agenteering.caos.action.CaosScriptNewFileAction">
      <add-to-group group-id="NewGroup" anchor="after" relative-to-action="NewFile" />
    </action>
    <action id="com.badahori.creatures.plugins.intellij.agenteering.caos.action.CaosScriptCopyForBoBCobAction"
            class="com.badahori.creatures.plugins.intellij.agenteering.caos.action.CaosScriptCopyForBoBCobAction"
            text="Copy for BoBCob" description="Copy script for BoBCob file editor formatting as neccessary">
      <add-to-group group-id="CutCopyPasteGroup" anchor="before" relative-to-action="CopyPaths" />
    </action>
  </actions>

  <module-components>
    <component>
      <implementation-class>
        com.badahori.creatures.plugins.intellij.agenteering.caos.project.module.CaosModuleSettingsComponent
      </implementation-class>
    </component>
  </module-components>

  <project-components>
    <component>
      <implementation-class>com.badahori.creatures.plugins.intellij.agenteering.caos.project.CaosProjectComponent
      </implementation-class>
    </component>
  </project-components>
  <application-components>
  </application-components>
</idea-plugin>